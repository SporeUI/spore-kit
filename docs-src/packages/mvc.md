<!-- Generated by documentation.js. Update this documentation by updating the source code. -->

## spore-kit-mvc

-   **See: [https://github.com/SporeUI/spore-kit/tree/master/packages/mvc][1]**

# 兼容 IE8 的 MVC 简单实现

### Examples

```javascript
// 统一引入 spore-kit
var $kit = require('spore-kit');
console.info($kit.mvc.Model);

// 单独引入 spore-kit-mvc
var $mvc = require('spore-kit-mvc');
console.info($mvc.Model);

// 单独引入一个组件
var $Model = require('spore-kit-mvc/Model');
```

## klass

-   **See: [https://github.com/ded/klass][2]**

class 的 ES5 实现

-   为代码通过 eslint 检查做了些修改

## delegate

事件对象绑定，将events中包含的键值对映射为代理的事件。

-   事件键值对格式可以为：
-   {'selector event':'method'}
-   {'event':'method'}
-   {'selector event':'method1 method2'}
-   {'event':'method1 method2'}

### Parameters

-   `action` **[Boolean][3]** 开/关代理，可选：['on', 'off']。
-   `root` **[Object][4]** 设置代理的根节点，可以是一个jquery对象，或者是混合了 spore-kit-evt/events 方法的对象。
-   `events` **[Object][4]** 事件键值对
-   `bind` **[Object][4]** 指定事件函数绑定的对象，必须为MVC类的实例。

## Base

基础工厂元件类

-   该类混合了 spore-kit-evt/events 的方法。

### Parameters

-   `options` **[Object][4]?** 选项

### Examples

```javascript
var Base = require('spore-kit-mvc/base');

var ChildClass = Base.extend({
	defaults : {
		node : null
	},
	build : function() {
		this.node = $(this.conf.node);
	},
	setEvents : function(action) {
		var proxy = this.proxy();
		this.node[action]('click', proxy('onclick'));
	},
	onclick : function() {
		console.info('clicked');
		this.trigger('click');
	}
});

var obj = new ChildClass({
	node : document.body
});

obj.on('click', function() {
	console.info('obj is clicked');
});
```

### Base#defaults

类的默认选项对象，绑定在原型上，不要在实例中直接修改这个对象

Type: [Object][4]

### Base#bound

存放代理函数的集合

Type: [Object][4]

### Base#conf

类的实际选项，setOptions 方法会修改这个对象

Type: [Object][4]

### Base#setOptions

深度混合传入的选项与默认选项，混合完成的选项对象可通过 this.conf 属性访问

#### Parameters

-   `options` **[Object][4]?** 选项

### Base#build

元件初始化接口函数，实例化元件时会自动首先调用

### Base#setEvents

元件事件绑定接口函数，实例化元件时会自动在 build 之后调用

#### Parameters

-   `action` **[String][5]** 绑定或者移除事件的标记，可选值有：['on', 'off'] (optional, default `'on'`)

### Base#proxy

函数代理，确保函数在当前类创建的实例上下文中执行。
这些用于绑定事件的代理函数都放在属性 this.bound 上。
功能类似 Function.prototype.bind 。
可以传递额外参数作为函数执行的默认参数，追加在实际参数之后。

#### Parameters

-   `name` **[string][5]** 函数名称 (optional, default `'proxy'`)

### Base#destroy

移除所有绑定事件，清除用于绑定事件的代理函数

## Model

模型类: 基础工厂元件类，用于做数据包装，提供可观察的数据对象

-   继承自 spore-kit-mvc/base

### Parameters

-   `options` **[Object][4]?** 初始数据

### Examples

```javascript
var Model = require('spore-kit-mvc/model');

var m1 = new Model({
	a : 1
});
m1.on('change:a', function(prevA){
	console.info(prevA);	// 1
});
m1.on('change', function(){
	console.info('model changed');
});
m1.set('a', 2);

var MyModel = Model.extend({
	defaults : {
		a : 2,
		b : 2
	},
	events : {
		'change:a' : 'updateB'
	},
	updateB : function(){
		this.set('b', this.get('a') + 1);
	}
});

var m2 = new MyModel();
console.info(m2.get('b'));	// 2

m2.set('a', 3);
console.info(m2.get('b'));	// 4

m2.set('b', 5);
console.info(m2.get('b'));	// 5
```

### Model#defaults

模型的默认数据

-   绑定在原型上，不要在实例中直接修改这个对象。

Type: [Object][4]

### Model#events

模型的事件绑定列表。

-   绑定在原型上，不要在实例中直接修改这个对象。
-   尽量在 events 对象定义属性关联事件。
-   事件应当仅用于自身属性的关联运算。
-   事件绑定格式可以为：
-   {'event':'method'}
-   {'event':'method1 method2'}

Type: [Object][4]

### Model#processors

模型数据的预处理器。

-   绑定在原型上，不要在实例中直接修改这个对象。

Type: [Object][4]

#### Examples

```javascript
processors : {
	name : {
		set : function(value){
			return value;
		},
		get : function(value){
			return value;
		}
	}
}
```

### Model#setOptions

深度混合传入的选项与默认选项，然后混合到数据对象中

#### Parameters

-   `options` **[Object][4]?** 选项

### Model#delegate

绑定 events 对象列举的事件。在初始化时自动执行了 this.delegate('on')。

#### Parameters

-   `action` **[String][5]** 绑定动作标记。可选：['on', 'off'] (optional, default `'on'`)

### Model#process

数据预处理

#### Parameters

-   `key` **[String][5]** 模型属性名称。或者JSON数据。
-   `val` **any?** 数据

### Model#set

设置模型数据

#### Parameters

-   `key` **([String][5] \| [Object][4])** 模型属性名称。或者JSON数据。
-   `val` **any?** 数据

### Model#get

获取模型对应属性的值的拷贝

-   如果不传参数，则直接获取整个模型数据。
-   如果值是一个对象，则该对象会被深拷贝。

#### Parameters

-   `key` **[String][5]?** 模型属性名称。

Returns **any** 属性名称对应的值

### Model#keys

获取模型上设置的所有键名

Returns **[Array][6]** 属性名称列表

### Model#remove

删除模型上的一个键

#### Parameters

-   `key` **[String][5]** 属性名称。

### Model#clear

清除模型中所有数据

### Model#destroy

销毁模型，不会触发任何change事件。

-   模型销毁后，无法再设置任何数据。

## View

视图类: 基础工厂元件类，用于对视图组件的包装

-   依赖 jQuery/Zepto
-   继承自 spore-kit-mvc/base

### Parameters

-   `options` **[Object][4]?** 选项
    -   `options.node` **([String][5] \| [Object][4])?** 选择器字符串，或者DOM元素，或者jquery对象，用于指定视图的根节点。
    -   `options.template` **[String][5]?** 视图的模板字符串，也可以是个字符串数组，创建视图DOM时会自动join为字符串处理。
    -   `options.events` **[Object][4]?** 用于覆盖代理事件列表。
    -   `options.role` **[Object][4]?** 角色对象映射表，可指定role方法返回的jquery对象。

### Examples

```javascript
var View = require('spore-kit-mvc/view');
var TPL = {
	box : [
		'<div>',
			'<button role="button"></button>',
		'</div>'
	]
};

var TestView = View.extend({
	defaults : {
		template : TPL.box
	},
	events : {
		'button click' : 'method1'
	},
	build : function(){
		this.role('root').appendTo(document.body);
	},
	method1 : function(evt){
		console.info(1);
	},
	method2 : function(evt){
		console.info(2);
	}
});

var obj1 = new TestView();
var obj2 = new TestView({
	events : {
		'button click' : 'method2'
	}
});

obj1.role('button').trigger('click');	// 1
obj2.role('button').trigger('click');	// 2
```

### View#defaults

类的默认选项对象，绑定在原型上，不要在实例中直接修改这个对象。

Type: [Object][4]

### View#events

视图的代理事件绑定列表，绑定在原型上，不要在实例中直接修改这个对象。

-   事件绑定格式可以为：
-   {'selector event':'method'}
-   {'selector event':'method1 method2'}

Type: [Object][4]

### View#setOptions

深度混合传入的选项与默认选项，混合完成的选项对象可通过 this.conf 属性访问

#### Parameters

-   `options` **[Object][4]?** 选项

### View#delegate

-   **See: spore-kit-mvc/delegate**

绑定 events 对象列举的事件。

-   在初始化时自动执行了 this.delegate('on')。

#### Parameters

-   `action` **[String][5]** 绑定动作标记。可选：['on', 'off'] (optional, default `'on'`)

### View#role

获取 / 设置角色对象指定的 jQuery 对象。

-   注意：获取到角色元素后，该 jQuery 对象会缓存在视图对象中

#### Parameters

-   `name` **[String][5]** 角色对象名称
-   `element` **[Object][4]?** 角色对象指定的dom元素或者 jQuery 对象。

Returns **[Object][4]** 角色名对应的 jQuery 对象。

### View#resetRoles

清除视图缓存的角色对象

### View#destroy

销毁视图，释放内存

[1]: https://github.com/SporeUI/spore-kit/tree/master/packages/mvc

[2]: https://github.com/ded/klass

[3]: https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Boolean

[4]: https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Object

[5]: https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/String

[6]: https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Array
